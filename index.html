<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Glow Form</title>
  <!-- Links -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
  <!-- As a heading -->
  <nav class="navbar bg-dark border-bottom border-body" data-bs-theme="dark">
    <div class="container-fluid d-flex justify-content-center">
      <span class="navbar-brand mb-0 h1">Glow Camp Form</span>
    </div>
  </nav>

  <div class="container d-flex flex-column align-items-center" style="margin-top: 2%;">
    <form class="add" style="width: 100%; max-width: 500px;" id="form">

      <div class="mb-3">
        <label for="EnglishName" class="form-label" style="margin-bottom: 2%;">Child Name</label>
        <input type="text" class="form-control" name="EnglishName" id="EnglishName" aria-describedby="name"
          style="margin-bottom: 2%;" required>
      </div>

      <div class="mb-3">
        <label for="NOKName" class="form-label" style="margin-bottom: 2%;">Parent's Name</label>
        <input type="text" class="form-control" name="NOKName" id="NOKName" aria-describedby="NOKName"
          style="margin-bottom: 2%;" required>
      </div>

      <div class="mb-3">
        <label for="RStoChild" class="form-label" style="margin-bottom: 2%;">Relationship to Child</label>
        <input type="text" class="form-control" name="RStoChild" id="RStoChild" aria-describedby="RStoChild"
          style="margin-bottom: 2%;" required>
      </div>

      <p>Dear Parent / legal guardian, <br> <br>

        Thank you for registering your child for Grace Baptist Church Youth Ministry (Glow) Gospel Camp 2024 via https://forms.gle/LhLuYR73VxtC38cW8. <br> <br>
        
        
        I, (full name of parent/legal guardian), parent/legal guardian of child, (full name of child), hereby affirm that I have read, understood, and accurately completed Glow Youth Camp 2024 in its entirety. <br> <br>
        
        I acknowledge and consent to the participant's full participation in the youth camp, including all activities, events, and programs planned during the duration of the camp. <br> <br>
        
        I understand and accept that the organizing committee and its representatives have taken all reasonable precautions to ensure the safety and well-being of all participants but cannot be held responsible for any accidents, injuries, illnesses, damages, or losses incurred during the camp, except in cases of proven gross negligence or willful misconduct. <br> <br>
        
        By providing this consent, I assume full responsibility for the participant's actions during the camp and agree to indemnify and hold harmless the organizing committee, its members, volunteers, and its associated organizations from any claims, liabilities, or expenses arising from the participant's involvement in the camp.<br> <br>
        
        This consent also grants the organizing committee permission to seek emergency medical treatment for the participant if deemed necessary, with the understanding that every effort will be made to contact me promptly in such situations. <br> <br>
        
        I confirm that I have provided accurate and complete information regarding the participant's medical and dietary needs, and I acknowledge my responsibility to update the committee should any changes occur prior to the camp.<br> <br>
        
        By signing this form, I confirm that I have read, understood, and voluntarily accepted this indemnity clause in its entirety.<br> <br>
        
        通过签名，我作为参与者的家长和法定监护人，特此确认我已完整阅读、理解并准确填写Glow Youth Camp 2024 表格。<br> <br>
        
        我同意并允许参与者全面参与青年营的所有活动、项目和安排。<br> <br>
        
        我理解并接受，组织委员会及其代表已采取一切合理措施确保所有参与者的安全和健康，但除非存在明确的重大过失或故意不当行为，否则不对青年营期间发生的任何意外、伤害、疾病、损失或损害负责。<br> <br>
        
        通过提供此同意书，我承担参与者在营会期间的行为责任，并同意赔偿和使组织委员会、其成员、志愿者及相关机构免受因参与者参与营会所产生的任何索赔、责任或费用。<br> <br>
        
        此外，本同意书授权组织委员会在必要时为参与者寻求紧急医疗服务，同时理解在此类情况下会尽一切努力及时与我取得联系。<br> <br>
        
        我确认已提供参与者的准确和完整的医疗及饮食需求信息，并承诺在营会开始前，如有任何变更，我将及时告知组织委员会。<br> <br>
        
        通过以下签名，我确认已阅读、理解并自愿接受本免责条款的所有内容。<br> <br></p>

      <div class="mb-3">
        <label for="signature" class="form-label">Signature</label>
        <canvas id="signatureCanvas" name="signature" class="border" style="width: 100%; height: 200px;"></canvas>
        <button type="button" class="btn btn-secondary mt-2" onclick="clearCanvas()">Clear Signature</button>
      </div>

      <button type="submit" class="btn btn-primary">Submit</button>
    </form>
  </div>

  <script>
   // Signature pad logic
const canvas = document.getElementById('signatureCanvas');
const ctx = canvas.getContext('2d');
canvas.width = canvas.offsetWidth;
canvas.height = canvas.offsetHeight;

let isDrawing = false;

// Function to handle the start of the drawing process
function startDrawing(e) {
  isDrawing = true;
  ctx.beginPath();
  // For touch events, adjust the coordinates based on the touch position
  const x = e.offsetX !== undefined ? e.offsetX : e.touches[0].clientX - canvas.getBoundingClientRect().left;
  const y = e.offsetY !== undefined ? e.offsetY : e.touches[0].clientY - canvas.getBoundingClientRect().top;
  ctx.moveTo(x, y);
}

// Function to handle the drawing process
function draw(e) {
  if (isDrawing) {
    e.preventDefault(); // Prevent scrolling when drawing on touch devices
    const x = e.offsetX !== undefined ? e.offsetX : e.touches[0].clientX - canvas.getBoundingClientRect().left;
    const y = e.offsetY !== undefined ? e.offsetY : e.touches[0].clientY - canvas.getBoundingClientRect().top;
    ctx.lineTo(x, y);
    ctx.stroke();
  }
}

// Function to handle the end of the drawing process
function stopDrawing() {
  isDrawing = false;
  ctx.closePath();
}

// Event listeners for mouse and touch
canvas.addEventListener('mousedown', startDrawing);
canvas.addEventListener('mousemove', draw);
canvas.addEventListener('mouseup', stopDrawing);

// Touch event listeners
canvas.addEventListener('touchstart', (e) => {
  // Prevent the default behavior of touch events (scrolling)
  e.preventDefault();
  startDrawing(e);
});
canvas.addEventListener('touchmove', (e) => {
  e.preventDefault();
  draw(e);
});
canvas.addEventListener('touchend', stopDrawing);

// Clear canvas function
function clearCanvas() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
}


    // Convert canvas to base64 string for form submission
    function getSignatureBase64() {
      return canvas.toDataURL('image/png');
    }

    // Form submission logic
    document.querySelector('.add').addEventListener('submit', (e) => {
      e.preventDefault();

      // Capture form data
      const formData = {
        EnglishName: document.getElementById('EnglishName').value,
        signature: getSignatureBase64(), // Get base64 string from canvas
        NOKName: document.getElementById('NOKName').value,
        RStoChild: document.getElementById('RStoChild').value,
      };

      // Log data to console (for testing)
      console.log('Form Data:', formData);

      // Use your existing Firebase logic to add the document
      // e.g., addDoc(colRef, formData)
    });
  </script>

  <script src="bundle.js"></script>
</body>
</html>
